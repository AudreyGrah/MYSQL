<!doctype html>
<html lang="fr">

<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">

    <title>Cours SQL - Entreprise</title>
</head>

<body>
    <main class="container">

        <h1 class="text-center">les requêtes MySQL part.1</h1>

        <!-- section1 -->
        <section class="row">
            <div class="col-12">
                <h2 class="text-center">1 - Bases d'une BDD</h2>

                <ul>
                    <li>Créer une BDD <code>CREATE DATABASE nombdd CHARACTER SET 'utf8';</code> </li>
                    <li>Voir les BDD qui se trouvent dans notre serveur : <code>SHOW DATABASES;</code> </li>
                    <li>Utiliser une BDD : <code>USE nombdd;</code> </li>
                    <li>Supprimer une base de donnée : <code>DROP DATABASE IF EXISTS nombdd</code> </li>
                </ul>


            </div>

        </section>

        <!-- section 2 -->

        <section class="row">
            <div class="col-12">
                <h2 class="text-center">2- Créer une table et ses colonnes</h2>
                <ul>
                    <li>Créer une table dans la BDD entreprise :
                        <code>CREATE TABLE IF NOT EXISTS employes (id_employes int(3) NOT NULL AUTO_INCREMENT,prenom varchar(20) DEFAULT NULL,nom varchar(20) DEFAULT NULL,sexe enum('f', 'm') NOT NULL,service varchar(30) DEFAULT NULL,salaire float DEFAULT NULL,PRIMARY KEY (id_employes))ENGINE=InnoDB DEFAULT CHARSET=latin1; </code>
                    </li>
                    <li>Ici on a d'abord créer une table. On dit ensuite les chaps qui vont composer la table
                        (id_employes, prenom,nom,sexe, service, salaire). On instaure le fait que la clé principale (PK)
                        est id_employes. </li>
                    <li>Insérer les données dans la table employes. <br>

                        <code>INSERT INTO employes (id_employes, prenom, nom, sexe, service, date_embauche, salaire) VALUES <br> (350, 'Jean-pierre', 'Laborde', 'm', 'direction', '1999-12-09', 5000), <br>(388, 'Clement', 'Gallet', 'm', 'commercial', '2000-01-15', 2300), <br>(415, 'Thomas', 'Winter', 'm', 'commercial', '2000-05-03', 3550), <br>(417, 'Chloe', 'Dubar', 'f', 'production', '2001-09-05', 1900), <br>(491, 'Elodie', 'Fellier', 'f', 'secretariat', '2002-02-22', 1600), <br>(509, 'Fabrice', 'Grand', 'm', 'comptabilite', '2003-02-20', 1900), <br>(547, 'Melanie', 'Collier', 'f', 'commercial', '2004-09-08', 3100), <br>(592, 'Laura', 'Blanchet', 'f', 'direction', '2005-06-09', 4500), <br>(627, 'Guillaume', 'Miller', 'm', 'commercial', '2006-07-02', 1900), <br>(655, 'Celine', 'Perrin', 'f', 'commercial', '2006-09-10', 2700), <br>(699, 'Julien', 'Cottet', 'm', 'secretariat', '2007-01-18', 1390), <br>(701, 'Mathieu', 'Vignal', 'm', 'informatique', '2008-12-03', 2000), <br>(739, 'Thierry', 'Desprez', 'm', 'secretariat', '2009-11-17', 1500), <br>(780, 'Amandine', 'Thoyer', 'f', 'communication', '2010-01-23', 1500), <br>(802, 'Damien', 'Durand', 'm', 'informatique', '2010-07-05', 2250), <br>(854, 'Daniel', 'Chevel', 'm', 'informatique', '2011-09-28', 1700), <br>(876, 'Nathalie', 'Martin', 'f', 'juridique', '2012-01-12', 3200), <br>(900, 'Benoit', 'Lagarde', 'm', 'production', '2013-01-03', 2550), <br>(933, 'Emilie', 'Sennard', 'f', 'commercial', '2014-09-11', 1800), <br>(990, 'Stephanie', 'Lafaye', 'f', 'assistant', '2015-06-02', 1775); <br></code>
                    </li>
                </ul>
            </div>
        </section>

        <!-- section 3 -->


        <section class="row">
            <div class="col-12">
                <h2 class="text-center">3- SELECT et DISTINCT</h2>
            </div>
            <div class="col-12 col-md-6">
                <ul>
                    <li>Pour voir tout le contenu d'une table, on va utiliser : <code>
                        SELECT * FROM employes;
                    </code> </li>
                    <li>Pour sélectionner les prénoms et les noms des employes :
                        <code>SELECT nom, prenom FROM employes;</code>
                    </li>
                    <li>Afficher les données sans doublons : <code>DISTINCT nom_colonne FROM nom_table</code> </li>
                </ul>
            </div>

            <div class="col-12 col-md-6">
                <div class="alert alert-danger">
                    <p>Les requêtes ne sont pas sensibles à la casse cepedant une convention indique qu'il faut mettre
                        les mot cléfs en majuscule. C'est ainsi plus facile de s'y retrouver dans le code</p>
                </div>
            </div>
        </section>

        <!-- section 4 -->

        <section class="row">
            <div class="col-12">
                <h2 class="text-center">4- Les conditions</h2>
            </div>

            <div class="col-12 col-md-4">
                <h3 class="text-center">a) le mot cléf <code>WHERE</code> </h3>
                <ul>
                    <li class="alert alert-success">Pour chercher une condition sur une partie des données :
                        <code>SELECT nomcolonne, nomcolonne FROM nomtable WHERE nomcolonne ="nomdonnée"</code>
                    </li>
                    <li>Ici si vous chercher à voir toutes les informations des employés masculin on peut faire le code
                        suivant : <code>SELECT * FROM employes WHERE sexe="m"</code></li>
                    <li>Exo : Quel est le code pour afficher le salaire, le nom de famille et sexe de élodie :
                        <code>SELECT nom, prenom, salaire FROM employes WHERE prenom="Elodie";</code>
                    </li>
                    <li>Exo : Afficher le nom, le prénom et le salaire de la personne qui gagne 1390euro <br>
                        <code>SELECT nom, prenom, salaire FROM employes WHERE salaire="1390";</code>
                    </li>

                </ul>
            </div>

            <div class="col-12 col-md-4">
                <h3 class="text-center">b) le mot cléf BETWEEN</h3>
                <ul>
                    <li class="alert alert-success">Nous cherchons grâce à notre condition, quelque chose qui est
                        contenue entre deux élèments.
                        <code>SELECT * FROM nomtable WHERE nomcolonne BETWEEN "donnée" AND "donnée";</code>
                    </li>
                    <li class="alert alert-danger"> ATTENTION !! Dans une BDD, les dates sont TOUJOURS au format
                        états-unien => YYYY-MM-DD(Par exemple 2022/01/27)</li>
                    <li>Exo : Trouver toutes les informations sur les personnes embauchées entre 1 janvier 2006 et le 1
                        janvier 2010 <code>
                            SELECT * FROM employes WHERE date_embauche BETWEEN "2006/01/01" AND "2010/01/01";
                        </code> </li>
                </ul>
            </div>

            <div class="col-12 col-md-4">
                <h3 class="text-center">
                    c) le mot clef <code>LIKE</code>
                </h3>
                <ul>
                    <li class="alert alert-success"> Ici, on affiche les employés dont le prénom commence par "s" :
                        <code>SELECT * FROM employes WHERE prenom LIKE 's%'; </code>
                    </li>
                    <li>Dans cette ligne de code, le pourcentage signifie que l'on recherche s en début de mot ainsi le
                        pourcentage signifie que des caractères viennent à la suite</li>
                    <li>Avec la présence du pourcentage avant et après le caractères recherché, nous demandons au
                        système de trouver des enregistrements contenant l'expression</li>
                    <li>EXO : Rerchercher toutes les informations sur les salarié ayant un nom composé.
                        <code>SELECT * FROM employes WHERE prenom LIKE '%-%';</code>
                    </li>
                </ul>
            </div>

            <div class="col-12 col-md-6">
                <h3 class="text-center">
                    d) CURDATE()
                </h3>
                <ul>
                    <li class="alert alert-success"> CURDATE permet de fair eune requêtequi donne la date du serveur
                        (date du jour) : <code>SELECT CURDATE();</code> </li>
                    <li>Grâce à CURDATE, nous pouvons donc sélectionner des élèments entre une date donnée et
                        aujourd'hui : CURDATE() = current date (date d'aujourd'hui) </li>
                    <li>Exo : afficher toutes les infos sur les employés embauchées entre début 2008 et aujourd'hui :
                        <code>  SELECT * FROM employes WHERE date_embauche BETWEEN "2008/01/01" AND CURDATE();</code>


                    </li>
                </ul>
            </div>

            <div class="col-12 col-md-6">
                <h3 class="text-center">
                    e) IN
                </h3>
                <ul>
                    <li>IN permet de faire la même chose que = dans le WHERE sauf qu'il permet de sélectionner plusieurs
                        données <code>SELECT * FROM employes WHERE prenom IN('Mathieu', 'Amandine');  </code> </li>
                    <li class="alert alert-success">Egal (=) permet d'annoncer une seule valeur tandis que IN permet
                        d'annoncer plusiuers valeur.</li>
                    <li> Trouver les employes qui ne sont pas au service compta ni au service informatique et ranger les
                        services par ordre
                        croissant.<code>SELECT prenom, nom, service FROM employes WHERE service NOT IN('comptabilité','informatique')ORDER BY service ASC;</code>
                    </li>
                    <li>
                        Exo : afficher le nom, le service et le salaire des gens travaillant à la direction et au
                        secrétariat en classant les salaires du plus bas au plus haut (asc)
                        <code> SELECT nom, service, salaire FROM employes WHERE service IN ('direction', 'secretariat')ORDER BY salaire ASC; </code>
                    </li>
                </ul>
            </div>

            <div class="col-12">
                <h3 class="text-center">
                    f) Le mot clef HAVING
                </h3>

                <p>Ici, on veut sélectionner seulement les services qui ont plus de deux employés.
                    <code>SELECT service, COUNT(*) AS nombre_employes FROM employes GROUP BY service HAVING COUNT(*) > 2;</code>
                    <br>
                    Grâce à COUNT(*) suivi du mot clef AS on créé une colonne qui s'apelle "nombre_employes". En mettant
                    GROUP BY on décide grâce à quelle colonne on va rassembler nos employés
                </p>
            </div>
        </section>


        <!-- section 5 -->

        <section class="row">
            <div class="col-12">
                <h2 class="text-center">
                    5- Les opérateurs de comparaison
                </h2>
            </div>
            <div class="col-12">
                <table class="table table-striped table-hover" id="tableComparaisons">
                    <thead>
                        <tr>
                            <th scope="col">Opérateur</th>
                            <th scope="col">Symbole</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <th scope="row">=</th>
                            <td>Est égal à</td>
                        </tr>
                        <tr>
                            <th scope="row">&gt;</th>
                            <td>Strictement supérieur à</td>
                        </tr>
                        <tr>
                            <th scope="row">&lt;</th>
                            <td>Strictement inférieur à</td>
                        </tr>
                        <tr>
                            <th scope="row">&gt;=</th>
                            <td>Supérieur ou égal à</td>
                        </tr>
                        <tr>
                            <th scope="row">&lt;=</th>
                            <td>Inférieur ou égal à</td>
                        </tr>
                        <tr>
                            <th scope="row">&lt; &gt; ou !=</th>
                            <td>est différent de</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <div class="col-12 col-md-6">
                <h3 class="text-center">&) l'opérateur != ou &gt; &lt; </h3>
                <ul>
                    <li>Je veux afficher le nom, le prénom et le service de tous les employes qui ne sont pas au service
                        direction :
                        <code>SELECT nom, prenom, service FROM employes WHERE service != "direction";
                            <!-- <> ou != c'est exactement pareil  -->
                    </li>
                    <li> SELECT * FROM nomtable WHERE nomcolonne != "donnée"; </li>
                </ul>
            </div>

            <div class="col-12 col-md-6">
                <h3 class="text-center">b) L'opérateur &gt;</h3>
                <p>Afficher toutes les informations sur les tous les employés qui gagnent plus que 3000 <code>SELECT * FROM employes WHERE salaire > "3000"; </code>
                        </p>
            </div>
        </section>

        <!-- section 6 -->

        <section class="row">
            <div class="col-12">
                <h2 class="text-center">
                    6- Classement avec ORDER BY
                </h2>
                <ul>
                    <li>Grâce à ORDER BY on classe les données par ordre alphabétique ou numérique.
                    </li>
                    <li>On peut par exemple
                        choisir de rangé notre tableau par ordre alphabétique pour les noms de famille
                        <code>SELECT * FROM employes ORDER BY nom ASC;</code>
                    </li>
                    <li class="alert alert-warning"> Attention, si on ne précise pas ASC (ascendant = croissant) OU DESC
                        (descendant =
                        décroissant) , ce sera
                        naturellement trier dans l'ordre croissant (du + petit au + grand)
                    </li>
                    <li>Fonctionne aussi bien avec des valeurs string qu'avec des valeurs number. Classez les personnes
                        en fonctions du salaire qu'elle touchent du plus grand au plus petit
                        <code>SELECT * FROM employes ORDER BY salaire DESC;</code>
                    </li>
                    <li>ORDER BY permet aussi de trier sur plusieurs colonnes,
                        <code>SELECT nom, prenom, service, salaire FROM employes ORDER BY sexe ASC, salaire ASC;</code>
                    </li>
                </ul>
            </div>
        </section>

        <!-- section 7 -->

        <section class="row">
            <div class="col-12">
                <h2 class="text-center">7 Limiter les résultats avec le mot clef LIMIT</h2>
                <ul>
                    <li class="alert alert-danger">LIMIT fonctionne avec deux chiffres : <code>LIMIT 0,3</code> le
                        premier défini l'enregistrement, le second chiffre nous indique combien de résultats nous
                        voulons afficher. </li>
                    <li>exo : Afficher les employés en les classant par salaire (du + grand au + petit) et en limitant
                        en 5 plus grand salaire <code>SELECT * FROM employes ORDER BY salaire DESC LIMIT 0,5; </code>
                    </li>
                </ul>
            </div>
        </section>

        <!-- section 8 -->

        <section class="row">
            <div class="col-12">
                <h2 class="text-center">8- Réaliser des calculs dans nos requêtes</h2>
                <p>Les opérateurs que nous connaissons déjà peuvent être utiliser dans le terminal. Ainsi le signe de la
                    multiplication '*'. </p>
                <p>Exo : Afficher les prénoms et les noms des employés ainsi que leurs salaires anuelle.
                    <code>SELECT nom, prenom, salaire, salaire*12 FROM employes; </code>
                </p>
            </div>

            <div class="col-12 col-md-6">
                <h3 class="text-center">
                    a) Utiliser un Alias grâce au mot clef AS
                </h3>
                <ul>
                    <li>En utilisant le code du dessus , on va avoir une colonne provisoir mais qui n'as pas de nom
                        défini</li>
                    <li>Grâce au mot clef AS, on peut créer notre colonne ponctuelle mais qui aura un nom qui fait sens
                        et grâce à laquelle on pourra par exemple choisir d'ordonner notre tableau </li>
                    <li>EXO : faire la même requêtes que celle du dessus en donnant un alias "salaire_anuelle" et en
                        ordonnant la liiste du salaire_anuelle du plus élevé au plus bas
                        <code>SELECT nom, prenom, salaire, salaire*12 AS salaire_anuelle FROM employes ORDER BY salaire_anuelle DESC;</code>
                    </li>
                    <li>Exo : en partant du principe que l'on travaille 150h dans le mois, trouver le salaire_heure des
                        employés
                        <code>SELECT nom, prenom, salaire, salaire/150 AS salaire_heure from employes ORDER BY salaire_heure ASC;</code>
                    </li>
                </ul>

            </div>

            <div class="col-12 col-md-6">
                <h3 class="text-center">
                    b) Calculer une somme SUM() et une moyenne AVG()
                </h3>
                <ul>
                    <li> Grâce au code qui suit, on va pouvoir calculer la somme total des salaires annueles des
                        employés : <code>SELECT SUM(salaire*12) AS salaire_annuel_employes FROM employes;</code> </li>
                    <li>Exo : Calculer le salaire mensuel moyen d'un employé
                        <code>SELECT AVG(salaire) AS moyenne_salaire_mensuel FROM employes;</code>
                    </li>
                </ul>
            </div>

            <div class="col-12 col-md-6">
                <h3 class="text-center">c) Arrondir un nombre grâce au mot cléf ROUND() </h3>
                <ul>
                    <li class="alert alert-danger">Il faut savoir qu'il est possible de cumuler deux notions comme AVG()
                        et ROUND() : <code>ROUND(AVG())</code> </li>
                    <li>Exo : Faire la même requête qu'au dessus en arrondissant le salaire moyen d'un employé
                        <code>SELECT ROUND(AVG(SALAIRE)) AS moyenne_salaire_mensuel_arrondi FROM employes;</code>
                    </li>
                </ul>
            </div>
            <div class="col-12 col-md-6">
                <h3 class="text-center">
                    d) Compter grâce à COUNT()
                </h3>
                <p>Grâce au mot clé COUNT() on va pouvoir compter par exemple le nombre d'employés de sexe féminin
                    <code>SELECT COUNT(*) AS employe_femmes  FROM employes WHERE sexe="f";</code>
                </p>
            </div>

            <div class="col-12">
                <h3 class="text-center">e) Isoler une valeur min ou max grâce à MIN() ou MAX() </h3>
                <ul>
                    <li>Grâce à MIN(), on peut par exemple trouver le salaire le plus bas de l'entreprise :
                        <code>SELECT MIN(salaire) FROM employes;</code>
                    </li>
                    <li>La requête simple <code>SELECT prenom, MIN(salaire) from employes;</code> ne fonctionne pas car
                        il faut une requête imbriquée pour que le terminal comprenne ce que l'on veut faire. Il faudra
                        donc la requête suivante :
                        <code>SELECT prenom, salaire FROM employes WHERE salaire=(SELECT MIN(SALAIRE) FROM employes);</code>
                        Ici on sélectionne tout d'abord le salaire minimum puis on cherche le prénom et le salaire de la
                        personne qui à le plus bas salaire.
                    </li>
                    <li class="alert alert-danger">Le système exécute d'abord la requête entre parenthèses (requête
                        imbriquée) et l'utilise
                        comme source pour l'autre requête</li>
                </ul>
            </div>
        </section>


        <!-- section 9 -->

        <section class="row">

            <div class="col-12">
                <h2 class="text-center">
                    9- Les conditions multiples
                </h2>
                <p>Grâce au conditions multiples, on peut vérifier plusieurs instructions. Par exemple on peut
                    sélectionner les emplyés qui travaillent dans le service commercial et qui gagne plus de 2000 euro
                    <code>SELECT nom, prenom, salaire, service FROM employes WHERE service="commercial" and salaire >= 2000;</code>
                </p>
            </div>

            <div class="col-12">
                <h3 class="text-center">a) Ordre de priorité "OR" et "AND"</h3>
                <ul>
                    <li>Lorsqu'il y a à la fois OR et AND dans la même requête, le système lit d'abord la condition de
                        la droite vers la gauche. Exemple :
                        <code>SELECT nom, prenom, salaire FROM employes WHERE service="production" AND salaire="1900" OR salaire="2300";</code>
                    </li>
                    <li>Pour garantir l'ordre naturel de lecture (de gauche à droite) on va utiliser les parenthèses
                        <code>SELECT nom, prenom, salaire FROM employes WHERE service="production" AND (salaire="1900" OR salaire="2300");</code>
                    </li>
                </ul>
            </div>
        </section>

        <!-- section 10 -->

        <section class="row">
            <div class="col-12">
                <h2 class="text-center">
                    10- Les regroupements avec GROUP BY
                </h2>
                <ul>
                    <li>Grâce au code suivant, on peut connaître le nombre d'employés par services :
                        <code>SELECT service, COUNT(*) AS nombre_employes FROM employes GROUP BY service;</code> La
                        virgule qui sépare service et COUNT(*) sert à signifier 'et'. On dit aussi sélectionne service
                        et compte le nombre d'employés.
                    </li>
                    <li></li>
                </ul>
            </div>
        </section>

    </main>






    <!-- fin du code + js -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p"
        crossorigin="anonymous"></script>
</body>

</html>